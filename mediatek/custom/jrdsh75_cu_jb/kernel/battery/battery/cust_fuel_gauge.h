#include <mach/mt_typedefs.h>

#define FGAUGE_VOLTAGE_FACTOR           2.44 // mV
#define FGAUGE_CURRENT_FACTOR           6.25 // uV/Rsns
#define FGAUGE_CURRENT_OFFSET_FACTOR    1.56 // uV/Rsns
#define FGAUGE_CAR_FACTOR               6.25 // uV/Rsns
#define FGAUGE_RSNS_FACTOR              0.02 // Ohm

//#define COMPASATE_OCV                   80 // mV for evb
#define COMPASATE_OCV                   40 // mV for phone

#define BATTERY_VOLTAGE_MINIMUM         3400
#define BATTERY_VOLTAGE_MAXIMUM         4200

#define BATTERY_CAPACITY_MAXIMUM        1497

#define TEMPERATURE_T0                  110
#define TEMPERATURE_T1                  0
#define TEMPERATURE_T2                  25
#define TEMPERATURE_T3                  50
#define TEMPERATURE_T                   255 // This should be fixed, never change the value

//#define BATT_CAPACITY                   1280
#define BATT_CAPACITY                   1478

#define ENABLE_SW_COULOMB_COUNTER       0 // 1 is enable, 0 is disable
//#define ENABLE_SW_COULOMB_COUNTER       1 // 1 is enable, 0 is disable

//#define FG_CURRENT_OFFSET_DISCHARGING 	31
#define FG_CURRENT_OFFSET_DISCHARGING 	0

#define FG_RESISTANCE 	20

#define FG_METER_RESISTANCE 	0
//#define FG_METER_RESISTANCE 	540 // current meter

//#define MAX_BOOTING_TIME_FGCURRENT	5*6 // 5 seconds, 6 points = 1s
#define MAX_BOOTING_TIME_FGCURRENT	1*10 // 10s

#if defined(CONFIG_POWER_EXT)
//#define OCV_BOARD_COMPESATE	32 //mV 
#define OCV_BOARD_COMPESATE	72 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#else
//#define OCV_BOARD_COMPESATE	0 //mV 
//#define OCV_BOARD_COMPESATE	48 //mV 
//#define OCV_BOARD_COMPESATE	25 //mV 
#define OCV_BOARD_COMPESATE	0 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
//#define R_FG_BOARD_SLOPE	1057 //slope
//#define R_FG_BOARD_SLOPE	1075 //slope
#endif

#define Q_MAX_POS_50	1497
#define Q_MAX_POS_25	1478
#define Q_MAX_POS_0		1458
#define Q_MAX_NEG_10	1282

#define Q_MAX_POS_50_H_CURRENT	1485
#define Q_MAX_POS_25_H_CURRENT	1466
#define Q_MAX_POS_0_H_CURRENT	1420
#define Q_MAX_NEG_10_H_CURRENT	1132

#define R_FG_VALUE 				20 // mOhm, base is 20
#define CURRENT_DETECT_R_FG	100  //10mA

#define OSR_SELECT_7			0

#define CAR_TUNE_VALUE			87 //1.00

/////////////////////////////////////////////////////////////////////
// <DOD, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _BATTERY_PROFILE_STRUC
{
    kal_int32 percentage;
    kal_int32 voltage;
} BATTERY_PROFILE_STRUC, *BATTERY_PROFILE_STRUC_P;

typedef enum
{
    T1_0C,
    T2_25C,
    T3_50C
} PROFILE_TEMPERATURE;

// T0 -10C
BATTERY_PROFILE_STRUC battery_profile_t0[] =
{
	{0   , 4174},
	{2   , 4158},
	{5   , 4112},
	{7   , 4074},
	{9   , 4053},
	{12  , 4038},
	{14  , 4023},
	{16  , 3998},
	{19  , 3958},
	{21  , 3941},
	{23  , 3933},
	{26  , 3922},
	{28  , 3910},
	{30  , 3897},
	{33  , 3881},
	{35  , 3867},
	{37  , 3854},
	{40  , 3842},
	{42  , 3833},
	{44  , 3824},
	{47  , 3818},
	{49  , 3812},
	{51  , 3806},
	{54  , 3801},
	{56  , 3798},
	{58  , 3793},
	{61  , 3791},
	{63  , 3788},  
	{65  , 3786}, 
	{68  , 3784},
	{70  , 3779},
	{72  , 3776},  
	{74  , 3769},
	{77  , 3762},
	{79  , 3751},
	{82  , 3740},
	{84  , 3728},
	{86  , 3721},
	{88  , 3714},
	{91  , 3709},
	{93  , 3700},
	{95  , 3674},
	{98  , 3600},
	{99  , 3550},
	{99  , 3522},
	{100 , 3506},
	{100 , 3496},
	{100 , 3489},
        {100 , 3485},
        {100 , 3482},
        {100 , 3479},
        {100 , 3477},
        {100 , 3476},
        {100 , 3474},
        {100 , 3473},
        {100 , 3400},
        {100 , 3400},
        {100 , 3400},
        {100 , 3400}
};      
        
// T1 0C
BATTERY_PROFILE_STRUC battery_profile_t1[] =
{
	{0   , 4167},
	{2   , 4111},
	{4   , 4093},
	{6   , 4073},
	{8   , 4030},
	{10  , 4000},
	{12  , 3982},
	{14  , 3970},
	{16  , 3961},
	{18  , 3953},
	{20  , 3948},
	{22  , 3943},
	{25  , 3933},
	{27  , 3923},
	{29  , 3913},
	{31  , 3902},
	{33  , 3892},
	{35  , 3878},
	{37  , 3864},
	{39  , 3850},
	{41  , 3837},
	{43  , 3826},
	{45  , 3818},
	{47  , 3811},
	{49  , 3806},
	{51  , 3800},
	{53  , 3795},
	{55  , 3792},  
	{57  , 3789}, 
	{59  , 3787},
	{61  , 3786},
	{63  , 3785},  
	{66  , 3785},
	{68  , 3784},
	{70  , 3782},
	{72  , 3781},
	{74  , 3778},
	{76  , 3775},
	{78  , 3769},
	{80  , 3759},
	{82  , 3746},
	{84  , 3731},
	{86  , 3717},
	{88  , 3710},
	{90  , 3706},
	{92  , 3703},
	{94  , 3699},
	{96  , 3672},
  	{98  , 3571},
  	{100 , 3440},
  	{100 , 3404},
  	{100 , 3388},
  	{100 , 3378},
  	{100 , 3372},
  	{100 , 3369},
  	{100 , 3369},
  	{100 , 3369},
  	{100 , 3369},
  	{100 , 3369}
}; 
// T2 25C
BATTERY_PROFILE_STRUC battery_profile_t2[] =
{
	{0   , 4182},
	{2   , 4160},
	{4   , 4142},
	{6   , 4124},
	{8   , 4106},
	{10  , 4091},
	{12  , 4081},
	{14  , 4071},
	{16  , 4048},
	{18  , 4017},
	{20  , 3995},
	{22  , 3982},
	{24  , 3973},
	{26  , 3967},
	{28  , 3959},
	{30  , 3948},
	{32  , 3937},
	{34  , 3926},
	{36  , 3914},
	{38  , 3901},
	{40  , 3885},
	{42  , 3868},
	{44  , 3853},
	{46  , 3840},
	{48  , 3831},
	{50  , 3824},
	{53  , 3816},
	{55  , 3810},  
	{57  , 3805}, 
	{59  , 3799},
	{61  , 3794},
	{63  , 3790},  
	{65  , 3786},
	{67  , 3783},
	{69  , 3779},
	{71  , 3776},
	{73  , 3774},
	{75  , 3771},
	{77  , 3765},
	{79  , 3755},
	{81  , 3746},
	{83  , 3734},
	{85  , 3718},
	{87  , 3698},
	{89  , 3694},
	{91  , 3692},
	{93  , 3691},
	{95  , 3687},
  	{97  , 3642},
  	{99  , 3527},
  	{101 , 3319},
  	{101 , 3285},
  	{101 , 3274},
  	{101 , 3267},
  	{101 , 3264},
  	{101 , 3264},
  	{101 , 3264},
  	{101 , 3264},
  	{101 , 3264}
}; 

// T3 50C
BATTERY_PROFILE_STRUC battery_profile_t3[] =
{
	{0   , 4188},
	{2   , 4167},
	{4   , 4148},
	{6   , 4129},
	{8   , 4111},
	{10  , 4095},
	{12  , 4078},
	{14  , 4062},
	{16  , 4050},
	{18  , 4031},
	{20  , 4013},
	{22  , 4000},
	{24  , 3988},
	{26  , 3975},
	{28  , 3963},
	{30  , 3951},
	{32  , 3939},
	{34  , 3928},
	{36  , 3917},
	{38  , 3905},
	{40  , 3893},
	{42  , 3879},
	{44  , 3862},
	{46  , 3846},
	{48  , 3835},
	{50  , 3826},
	{52  , 3819},
	{54  , 3812},  
	{56  , 3806}, 
	{58  , 3800},
	{60  , 3795},
	{62  , 3790},  
	{64  , 3786},
	{66  , 3782},
	{68  , 3777},
	{70  , 3772},
	{72  , 3762},
	{74  , 3754},
	{76  , 3748},
	{78  , 3741},
	{80  , 3733},
	{82  , 3724},
	{84  , 3710},
	{86  , 3695},
	{88  , 3678},
	{90  , 3677},
	{92  , 3676},
	{94  , 3673},
        {96  , 3661},
        {98  , 3586},
  	{100 , 3445},										
  	{101 , 3285},										
  	{101 , 3263},										
  	{101 , 3259},										
  	{101 , 3256},										
  	{101 , 3256},										
  	{101 , 3256},										
  	{101 , 3256},										
  	{101 , 3256}										
};              

// battery profile for actual temperature. The size should be the same as T1, T2 and T3
BATTERY_PROFILE_STRUC battery_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
	  {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
	  {0, 0},
    {0, 0}
};    

/////////////////////////////////////////////////////////////////////
// <Rbat, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _R_PROFILE_STRUC
{
    kal_int32 resistance; // Ohm
    kal_int32 voltage;
} R_PROFILE_STRUC, *R_PROFILE_STRUC_P;

// T0 -10C
R_PROFILE_STRUC r_profile_t0[] =
{
	{340    ,  4174},
	{340    ,  4158},
	{340    ,  4112},
	{340    ,  4074},
	{338    ,  4053},
	{348    ,  4038},
	{370    ,  4023},
	{413    ,  3998},
	{578    ,  3958},
	{678    ,  3941},
	{713    ,  3933},
	{720    ,  3922},
	{723    ,  3910},
	{725    ,  3897},
	{713    ,  3881},
	{710    ,  3867},
	{703    ,  3854},
	{698    ,  3842},
	{698    ,  3833},
	{698    ,  3824},
	{703    ,  3818},
	{705    ,  3812},
	{708    ,  3806},
	{713    ,  3801},
	{723    ,  3798},
	{728    ,  3793},
	{733    ,  3791},
	{730    ,  3788},  
	{733    ,  3786}, 
	{740    ,  3784},
	{738    ,  3779},
	{743    ,  3776},  
	{740    ,  3769},
	{740    ,  3762},
	{735    ,  3751},
	{730    ,  3740},
	{733    ,  3728},
	{753    ,  3721},
	{778    ,  3714},
	{820    ,  3709},
	{875    ,  3700},
	{925    ,  3674},
	{968    ,  3600},
	{875    ,  3550},
	{808    ,  3522},
	{770    ,  3506},
	{745    ,  3496},
	{728    ,  3489},
  	{718    ,  3485},
  	{710    ,  3482},
  	{703    ,  3479},
  	{700    ,  3477},
  	{693    ,  3476},
  	{698    ,  3474},
  	{693    ,  3473},
  	{518    ,  3400},
  	{518    ,  3400},
  	{518    ,  3400},
  	{518    ,  3400}
};

// T1 0C
R_PROFILE_STRUC r_profile_t1[] =
{
	{293    ,  4167},
	{293    ,  4111},
	{373    ,  4093},
	{388    ,  4073},
	{380    ,  4030},
	{390    ,  4000},
	{395    ,  3982},
	{400    ,  3970},
	{405    ,  3961},
	{410    ,  3953},
	{420    ,  3948},
	{430    ,  3943},
	{428    ,  3933},
	{430    ,  3923},
	{433    ,  3913},
	{430    ,  3902},
	{430    ,  3892},
	{418    ,  3878},
	{405    ,  3864},
	{393    ,  3850},
	{380    ,  3837},
	{375    ,  3826},
	{370    ,  3818},
	{373    ,  3811},
	{375    ,  3806},
	{378    ,  3800},
	{375    ,  3795},
	{383    ,  3792},  
	{383    ,  3789}, 
	{390    ,  3787},
	{395    ,  3786},
	{398    ,  3785},  
	{405    ,  3785},
	{405    ,  3784},
	{408    ,  3782},
	{413    ,  3781},
	{413    ,  3778},
	{418    ,  3775},
	{418    ,  3769},
	{413    ,  3759},
	{408    ,  3746},
	{398    ,  3731},
	{395    ,  3717},
	{395    ,  3710},
	{408    ,  3706},
	{435    ,  3703},
	{480    ,  3699},
	{525    ,  3672},
  	{545    ,  3571},
  	{605    ,  3440},
  	{515    ,  3404},
  	{473    ,  3388},
  	{453    ,  3378},
  	{440    ,  3372},
  	{425    ,  3369},
  	{425    ,  3369},
  	{425    ,  3369},
  	{425    ,  3369},
  	{425    ,  3369}
}; 

// T2 25C
R_PROFILE_STRUC r_profile_t2[] =
{
	{178   ,  4182},
	{178   ,  4160},
	{180   ,  4142},
	{183   ,  4124},
	{185   ,  4106},
	{188   ,  4091},
	{193   ,  4081},
	{198   ,  4071},
	{200   ,  4048},
	{198   ,  4017},
	{200   ,  3995},
	{203   ,  3982},
	{208   ,  3973},
	{215   ,  3967},
	{220   ,  3959},
	{225   ,  3948},
	{230   ,  3937},
	{238   ,  3926},
	{240   ,  3914},
	{238   ,  3901},
	{225   ,  3885},
	{208   ,  3868},
	{198   ,  3853},
	{185   ,  3840},
	{183   ,  3831},
	{185   ,  3824},
	{183   ,  3816},
	{185   ,  3810},  
	{188   ,  3805}, 
	{188   ,  3799},
	{188   ,  3794},
	{190   ,  3790},  
	{190   ,  3786},
	{193   ,  3783},
	{190   ,  3779},
	{190   ,  3776},
	{193   ,  3774},
	{198   ,  3771},
	{193   ,  3765},
	{183   ,  3755},
	{180   ,  3746},
	{180   ,  3734},
	{180   ,  3718},
	{175   ,  3698},
	{175   ,  3694},
	{180   ,  3692},
	{190   ,  3691},
	{205   ,  3687},
  	{203   ,  3642},
  	{225   ,  3527},
  	{298   ,  3319},
  	{218   ,  3285},
  	{188   ,  3274},
  	{173   ,  3267},
  	{165   ,  3264},
  	{165   ,  3264},
  	{165   ,  3264},
  	{165   ,  3264},
  	{165   ,  3264}
};

// T3 50C
R_PROFILE_STRUC r_profile_t3[] =
{
	{145    ,  4188},
	{145    ,  4167},
	{150    ,  4148},
	{150    ,  4129},
	{148    ,  4111},
	{150    ,  4095},
	{153    ,  4078},
	{153    ,  4062},
	{160    ,  4050},
	{155    ,  4031},
	{158    ,  4013},
	{160    ,  4000},
	{160    ,  3988},
	{163    ,  3975},
	{165    ,  3963},
	{168    ,  3951},
	{173    ,  3939},
	{178    ,  3928},
	{185    ,  3917},
	{188    ,  3905},
	{193    ,  3893},
	{188    ,  3879},
	{175    ,  3862},
	{160    ,  3846},
	{155    ,  3835},
	{153    ,  3826},
	{153    ,  3819},
	{155    ,  3812},  
	{158    ,  3806}, 
	{158    ,  3800},
	{158    ,  3795},
	{160    ,  3790},  
	{163    ,  3786},
	{168    ,  3782},
	{168    ,  3777},
	{170    ,  3772},
	{158    ,  3762},
	{155    ,  3754},
	{155    ,  3748},
	{155    ,  3741},
	{153    ,  3733},
	{153    ,  3724},
	{150    ,  3710},
	{150    ,  3695},
	{148    ,  3678},
	{148    ,  3677},
	{155    ,  3676},
	{160    ,  3673},
  	{165    ,  3661},
  	{175    ,  3586},
  	{200    ,  3445},
  	{218    ,  3285},
  	{163    ,  3263},
  	{153    ,  3259},
  	{148    ,  3256},
  	{148    ,  3256},
  	{148    ,  3256},
  	{148    ,  3256},
  	{148    ,  3256}
};

// r-table profile for actual temperature. The size should be the same as T1, T2 and T3
R_PROFILE_STRUC r_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
	  {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},   
    {0, 0},
    {0, 0},
    {0, 0},
	  {0, 0},
    {0, 0}
};    


int fgauge_get_saddles(void);
BATTERY_PROFILE_STRUC_P fgauge_get_profile(kal_uint32 temperature);

int fgauge_get_saddles_r_table(void);
R_PROFILE_STRUC_P fgauge_get_profile_r_table(kal_uint32 temperature);
